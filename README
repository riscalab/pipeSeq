#########################################################################################
ATACseq: analyze ATACseq bam files to call peaks and make tracks
#########################################################################################
npagane | 190702 | risca lab

######
to run
######

python ATACseq.py <1> <2> --<opts>

where:
    <1> =  how many cores to run pipeline with (integer, i.e. 14)
    <2> = directory with fastq/bam files and desired working directory (string, i.e. path/to/fastq)
    --<opts> additional options:
        --genomeRef = genome reference for alignment (string, i.e. path/to/genome)
            default: "/rugpfs/fs0/risc_lab/scratch/nvelez/genomes/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome"
        --blacklist = blacklist for filtering (string, i.e. path/to/blacklist)
            default: "/rugpfs/fs0/risc_lab/scratch/nvelez/blacklists/ATAC_blacklist.bed"
        --chromSize = sizes of chromosomes (string, i.e. path/to/genome/file)
            default: "/rugpfs/fs0/risc_lab/store/risc_data/downloaded/hg38/genome/chrom.sizes"
        --igvCommands = commands for IGV to capture images to tracks (string, i.e. path/to/commands)
            default: '/rugpfs/fs0/risc_lab/store/risc_soft/ATACseq/scripts/igvCommands'
        --mapq = the map quality threshold for alignment (int, i.e. 30)
            default: "30"
        --index = whether there are fastq files for the index reads or not (boolean, i.e. True)
            default: "False"
        --exclude = exclusion file to exclude certain samples from analysis (path/to/exclude)
            default: ""
        --snakemake = any snakemake flags for compilation (string, i.e. unlock)
            default: ""

###########
environment
###########

start cluster submission file with:
    source activate ATACseq
    echo `which python` # confirms you are in correct env

macs2 needs to run in a python2 env but snakemake requires python3. small indepedent conda env for macs2_python2
was created and exported via:
    conda activate macs2_python2
    conda env export >  macs2_python2.yml (in the conda directory i.e. /rugpfs/fs0/risc_lab/store/risc_soft/anaconda2/envs/macs2_python2/)
the yml file is then symlinked to the envs/ directory

##############
file structure
##############

ATACseq.py <executable>
Snakefile <constructs pipeline from rules>
rules/* <rules for executable pipeline with helper code>
scripts/* <R, python, or bash scripts to call in pipeline>
envs/* <stores indepedent and small conda environments for specific snakemake rules that would clash with main conda env>
